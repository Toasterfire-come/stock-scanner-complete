# =============================================================================
# STOCK SCANNER ENVIRONMENT CONFIGURATION
# =============================================================================
# Copy this file to .env and update with your actual values
# Last updated: December 2024 for Market Hours Manager and enhanced components

# =============================================================================
# DJANGO CORE SETTINGS
# =============================================================================
DJANGO_SETTINGS_MODULE=stockscanner_django.settings_production
DJANGO_SECRET_KEY=REPLACE_WITH_STRONG_RANDOM
DJANGO_ALLOWED_HOSTS=localhost,127.0.0.1,retailtradescanner.com,api.retailtradescanner.com,api.tradescanpro.com,tradescanpro.com,www.tradescanpro.com

# Logging format: use "default" on Windows unless python-json-logger is installed
LOG_FORMAT=default
LOG_LEVEL=INFO

# Frontend / CSRF (cross-site: tradescanpro.com -> api.tradescanpro.com)
FRONTEND_URL=https://tradescanpro.com
WORDPRESS_URL=https://retailtradescanner.com
CSRF_TRUSTED_ORIGINS=https://api.tradescanpro.com,https://api.retailtradescanner.com,https://tradescanpro.com,https://www.tradescanpro.com
PRIMARY_ORIGIN=https://tradescanpro.com

# Optional Sentry (set only in production if you use it)
SENTRY_DSN=
SENTRY_TRACES_SAMPLE_RATE=0

# =============================================================================
# DATABASE CONFIGURATION
# =============================================================================
# Current Database (XAMPP Development)
DB_ENGINE=django.db.backends.mysql
DB_NAME=stockscanner
DB_USER=root
DB_PASSWORD=
DB_HOST=localhost
DB_PORT=3306
CONN_MAX_AGE=60

# Alternative database URL format (optional)
# DATABASE_URL=mysql://root:@localhost:3306/stockscanner

# Production Database (for future deployment)
# DB_USER=stockscanner_user
# DB_PASSWORD=REPLACE_ME
# DATABASE_URL=mysql://stockscanner_user:REPLACE_ME@localhost:3306/stockscanner

# =============================================================================
# SITE CONFIGURATION
# =============================================================================
SITE_URL=https://retailtradescanner.com
SITE_DOMAIN=retailtradescanner.com
API_BASE_URL=https://api.tradescanpro.com

# CORS Origins (comma-separated)
CORS_ALLOWED_ORIGINS=https://retailtradescanner.com,https://api.retailtradescanner.com,https://api.tradescanpro.com,https://tradescanpro.com,https://www.tradescanpro.com

# =============================================================================
# PAYPAL CONFIGURATION (PRODUCTION SETTINGS)
# =============================================================================
# PayPal Environment (sandbox or live)
PAYPAL_MODE=live
PAYPAL_ENV=live

# PayPal API Credentials (REPLACE WITH YOUR ACTUAL CREDENTIALS)
PAYPAL_CLIENT_ID=REPLACE_WITH_PRODUCTION_CLIENT_ID
PAYPAL_CLIENT_SECRET=REPLACE_WITH_PRODUCTION_CLIENT_SECRET
PAYPAL_SECRET=REPLACE_WITH_PRODUCTION_CLIENT_SECRET

# PayPal URLs
PAYPAL_WEBHOOK_URL=https://retailtradescanner.com/wp-json/stock-scanner/v1/paypal-webhook
PAYPAL_RETURN_URL=https://retailtradescanner.com/membership-success/
PAYPAL_CANCEL_URL=https://retailtradescanner.com/membership-cancel/

# PayPal Security
PAYPAL_IPN_VERIFY=True

# =============================================================================
# MEMBERSHIP PLANS & PRICING (Updated December 2024)
# =============================================================================
# Bronze Plan - Entry Level
BRONZE_MONTHLY_PRICE=24.99
BRONZE_ANNUAL_PRICE=269.89

# Silver Plan - Professional
SILVER_MONTHLY_PRICE=49.99
SILVER_ANNUAL_PRICE=539.89

# Gold Plan - Premium
GOLD_MONTHLY_PRICE=99.99
GOLD_ANNUAL_PRICE=1079.89

# Trial Settings
FREE_TRIAL_DAYS=7
TRIAL_ENABLED=True

# =============================================================================
# EMAIL CONFIGURATION
# =============================================================================
# Email Backend
EMAIL_BACKEND=django.core.mail.backends.smtp.EmailBackend

# SMTP Settings (Gmail example)
EMAIL_HOST=smtp.gmail.com
EMAIL_PORT=587
EMAIL_USE_TLS=True
EMAIL_USE_SSL=False
EMAIL_HOST_USER=noreply.retailtradescanner@gmail.com
EMAIL_HOST_PASSWORD=REPLACE_WITH_APP_PASSWORD

# Email Addresses
DEFAULT_FROM_EMAIL=Stock Scanner <noreply.retailtradescanner@gmail.com>
SERVER_EMAIL=Stock Scanner Server <noreply.retailtradescanner@gmail.com>
ADMIN_EMAIL=admin@retailtradescanner.com

# Email Rate Limiting
EMAIL_RATE_LIMIT_PER_HOUR=250
EMAIL_RATE_LIMIT_PER_DAY=500
EMAIL_DELAY_BETWEEN=1

# =============================================================================
# STOCK API CONFIGURATION
# =============================================================================
# Yahoo Finance Settings
YFINANCE_RATE_LIMIT=0.25
YFINANCE_TIMEOUT=15
YFINANCE_RETRIES=3

# Alternative API Keys (optional)
FINNHUB_API_KEYS=
ALPHA_VANTAGE_API_KEY=

# =============================================================================
# PROXY CONFIGURATION
# =============================================================================
USE_PROXIES=True
PROXY_FILE=working_proxies.json
PROXY_TIMEOUT=10
PROXY_ROTATION_ENABLED=True

# =============================================================================
# MARKET HOURS MANAGER SETTINGS
# =============================================================================
# Market Hours (Eastern Time)
MARKET_PREMARKET_START=04:00
MARKET_OPEN=09:30
MARKET_CLOSE=16:00
MARKET_POSTMARKET_END=20:00

# Component Intervals (minutes)
STOCK_RETRIEVAL_INTERVAL=3
NEWS_SCRAPER_INTERVAL=5
EMAIL_SENDER_INTERVAL=10

# Market Hours Manager Settings
MARKET_HOURS_LOG_LEVEL=INFO
MARKET_HOURS_CHECK_INTERVAL=60
MARKET_HOURS_ENABLED=True

# Weekend Trading (usually False)
WEEKEND_TRADING_ENABLED=False

# =============================================================================
# STOCK SCANNER SETTINGS
# =============================================================================
DEFAULT_THREADS=15
DEFAULT_TIMEOUT=8
CSV_FILE=flat-ui__data-Fri Aug 01 2025.csv
MAX_SYMBOLS_PER_RUN=5000

# Scanning Settings
SCAN_ENABLED=True
SCAN_PREMARKET=True
SCAN_POSTMARKET=True
SCAN_REGULAR_HOURS=True

# =============================================================================
# CELERY CONFIGURATION (Task Queue)
# =============================================================================
CELERY_ENABLED=True
# CELERY_BROKER_URL=redis://127.0.0.1:6379/0 - commented out, use database broker instead
# CELERY_RESULT_BACKEND=redis://127.0.0.1:6379/0 - commented out, use database backend instead
CELERY_ACCEPT_CONTENT=json
CELERY_TASK_SERIALIZER=json
CELERY_RESULT_SERIALIZER=json
CELERY_TIMEZONE=America/New_York

# Celery Beat (Scheduled Tasks)
CELERY_BEAT_SCHEDULER=django_celery_beat.schedulers:DatabaseScheduler

# =============================================================================
# CACHE CONFIGURATION
# =============================================================================
# Preferred (used by settings): Redis URL + sessions in cache
# Use IPv4 to avoid Windows localhost/IPv6 issues
# REDIS_URL removed - using LocMem cache instead
# USE_REDIS_SESSIONS removed - using DB sessions instead

# Optional: legacy cache vars (ignored when REDIS_URL is set)
CACHE_BACKEND=locmem
CACHE_LOCATION=stock-scanner-cache
# CACHE_TIMEOUT=3600
# CACHE_MAX_ENTRIES=10000

# =============================================================================
# LOGGING CONFIGURATION
# =============================================================================
# LOG_FORMAT is set above. Set to "json" only if python-json-logger is installed.
PAYMENT_LOG_FILE=paypal_payments.log
ERROR_LOG_FILE=errors.log
DEBUG_LOG_FILE=debug.log

# Component Log Files
STOCK_RETRIEVAL_LOG_FILE=enhanced_stock_retrieval_working.log
NEWS_SCRAPER_LOG_FILE=news_scraper_with_restart.log
EMAIL_SENDER_LOG_FILE=email_sender_with_restart.log
MARKET_HOURS_LOG_FILE=market_hours_manager.log

# Log Rotation
LOG_MAX_SIZE=50MB
LOG_BACKUP_COUNT=5

# =============================================================================
# SECURITY SETTINGS
# =============================================================================
# Rate Limiting (middleware hourly)
MAX_REQUESTS_PER_MINUTE=60
MAX_REQUESTS_PER_HOUR=1000
MAX_REQUESTS_PER_DAY=10000

# Strict monthly limits are enforced by profile quotas; hourly by middleware:
RATE_LIMIT_FREE_USERS=100
RATE_LIMIT_AUTHENTICATED_USERS=1000
RATE_LIMIT_WINDOW=3600

# DRF throttling
API_RATE_LIMIT=1000/hour
API_THROTTLE_ANON=100/hour
API_THROTTLE_USER=1000/hour
THROTTLE_RATE_ANON=200/hour
THROTTLE_RATE_USER=2000/hour
THROTTLE_RATE_LOGGING=60/min

# Security Headers
SECURE_SSL_REDIRECT=True
SECURE_HSTS_SECONDS=31536000
SECURE_HSTS_INCLUDE_SUBDOMAINS=True
SECURE_HSTS_PRELOAD=True
SECURE_CONTENT_TYPE_NOSNIFF=True
X_FRAME_OPTIONS=DENY

# Session Security (cross-site cookies require None)
SESSION_COOKIE_SECURE=True
SESSION_COOKIE_HTTPONLY=True
SESSION_COOKIE_SAMESITE=None
CSRF_COOKIE_SECURE=True
CSRF_COOKIE_HTTPONLY=True
CSRF_COOKIE_SAMESITE=None

# =============================================================================
# API CONFIGURATION
# =============================================================================
# API Keys (if using internal API authentication)
API_KEY=
API_SECRET=

# =============================================================================
# MONITORING & ANALYTICS
# =============================================================================
# Performance Monitoring
MONITORING_ENABLED=True
PERFORMANCE_TRACKING=True
ERROR_TRACKING=True

# Health Check
HEALTH_CHECK_ENABLED=True
HEALTH_CHECK_URL=/health/

# Metrics
METRICS_ENABLED=True
METRICS_ENDPOINT=/metrics/

# =============================================================================
# BACKUP CONFIGURATION
# =============================================================================
BACKUP_ENABLED=True
BACKUP_SCHEDULE=daily
BACKUP_RETENTION_DAYS=30
BACKUP_STORAGE_PATH=/var/backups/stockscanner

# Database Backup
DB_BACKUP_ENABLED=True
DB_BACKUP_COMPRESSION=True

# =============================================================================
# DEVELOPMENT SETTINGS (REMOVE IN PRODUCTION)
# =============================================================================
# Set to False in production
DJANGO_DEBUG=False
DEBUG_TOOLBAR_ENABLED=False

# =============================================================================
# ENVIRONMENT INDICATORS
# =============================================================================
ENVIRONMENT=production
# Options: development, staging, production

# Feature Flags
FEATURE_MARKET_HOURS_MANAGER=True
FEATURE_RESTART_COMPONENTS=True
FEATURE_EMAIL_NOTIFICATIONS=True
FEATURE_NEWS_SCRAPING=True
FEATURE_PAYPAL_INTEGRATION=True

# =============================================================================
# EXTERNAL INTEGRATIONS
# =============================================================================
# WordPress Integration
WORDPRESS_ENABLED=True
WORDPRESS_API_URL=https://retailtradescanner.com/wp-json
WORDPRESS_API_KEY=

# Third-party Services
CLOUDFLARE_ENABLED=True
CLOUDFLARE_ZONE_ID=
CLOUDFLARE_API_TOKEN=

# =============================================================================
# DEPLOYMENT SETTINGS
# =============================================================================
# Server Configuration
SERVER_NAME=retailtradescanner.com
SERVER_PORT=8000
WORKERS=4
TIMEOUT=120

# SSL Configuration
SSL_ENABLED=True
SSL_CERT_PATH=/path/to/ssl/cert.pem
SSL_KEY_PATH=/path/to/ssl/key.pem

# =============================================================================
# NOTES FOR SETUP
# =============================================================================
# 1. Generate a new Django secret key:
#    python -c 'from django.core.management.utils import get_random_secret_key; print(get_random_secret_key())'
#
# 2. Update PayPal credentials with your actual production keys
#
# 3. Configure email settings with your SMTP provider
#
# 4. Set up Redis for caching and Celery (recommended for production)
#    - If Redis is down, the app will gracefully degrade (cache ignores exceptions)
#    - Prefer # REDIS_URL removed - using LocMem cache instead
#
# 5. Update all URLs to match your domain
#
# 6. Review security settings for production deployment
#
# 7. Set appropriate file permissions (600) for this .env file
#
# 8. Never commit this file to version control with real credentials

# Celery Configuration (database-based, no Redis required)
CELERY_ENABLED=false
CELERY_BROKER_URL=db+sqlite:///celery.db
CELERY_RESULT_BACKEND=db+sqlite:///celery_results.db
