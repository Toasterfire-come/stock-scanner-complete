/*! For license information please see 7582.1e229728.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[7582],{1946:(e,a,t)=>{t.d(a,{A:()=>s});const s=(0,t(6230).A)("shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]])},6987:(e,a,t)=>{t.d(a,{A:()=>s});const s=(0,t(6230).A)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])},7413:(e,a,t)=>{t.d(a,{Fc:()=>u,TN:()=>x});var s=t(2555),i=t(3986),r=t(9950),l=t(4364),c=t(90),d=t(4414);const n=["className","variant"],o=["className"],m=["className"],v=(0,l.F)("relative w-full rounded-lg border px-4 py-3 text-sm [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground [&>svg~*]:pl-7",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),u=r.forwardRef((e,a)=>{let{className:t,variant:r}=e,l=(0,i.A)(e,n);return(0,d.jsx)("div",(0,s.A)({ref:a,role:"alert",className:(0,c.cn)(v({variant:r}),t)},l))});u.displayName="Alert";r.forwardRef((e,a)=>{let{className:t}=e,r=(0,i.A)(e,o);return(0,d.jsx)("h5",(0,s.A)({ref:a,className:(0,c.cn)("mb-1 font-medium leading-none tracking-tight",t)},r))}).displayName="AlertTitle";const x=r.forwardRef((e,a)=>{let{className:t}=e,r=(0,i.A)(e,m);return(0,d.jsx)("div",(0,s.A)({ref:a,className:(0,c.cn)("text-sm [&_p]:leading-relaxed",t)},r))});x.displayName="AlertDescription"},7582:(e,a,t)=>{t.r(a),t.d(a,{default:()=>p});var s=t(2555),i=t(9950),r=t(827),l=t(9449),c=t(2169),d=t(809),n=t(1111),o=t(4779),m=t(6607),v=(t(7413),t(2033)),u=t(5508),x=t(6987),f=t(1946),h=t(4414);const g=d.Ik({code:d.Yj().min(6,"Verification code must be 6 digits").max(6,"Verification code must be 6 digits")}),p=()=>{var e,a,t;const[d,p]=(0,i.useState)(!1),[y,N]=(0,i.useState)(!1),j=(0,r.Zp)(),b=(0,r.zy)(),w=(null===(e=b.state)||void 0===e?void 0:e.email)||"your email",A=(null===(a=b.state)||void 0===a||null===(t=a.from)||void 0===t?void 0:t.pathname)||"/app/dashboard",{register:k,handleSubmit:F,formState:{errors:R}}=(0,l.mN)({resolver:(0,c.u)(g)});return(0,h.jsxs)("div",{className:"space-y-6",children:[(0,h.jsxs)("div",{className:"text-center",children:[(0,h.jsx)("div",{className:"flex justify-center mb-4",children:(0,h.jsx)(f.A,{className:"h-12 w-12 text-blue-500"})}),(0,h.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Two-Factor Authentication"}),(0,h.jsxs)("p",{className:"text-gray-600 mt-2",children:["Enter the 6-digit verification code sent to ",w]})]}),(0,h.jsxs)("form",{onSubmit:F(async e=>{p(!0);try{var a;const s=await u.FH.post("/auth/verify-2fa/",{code:e.code,email:w});var t;if(null!==s&&void 0!==s&&null!==(a=s.data)&&void 0!==a&&a.success)v.oR.success("Two-factor authentication successful!"),j(A,{replace:!0});else v.oR.error((null===s||void 0===s||null===(t=s.data)||void 0===t?void 0:t.message)||"Invalid verification code. Please try again.")}catch(s){v.oR.error("Verification failed. Please try again.")}finally{p(!1)}}),className:"space-y-4",children:[(0,h.jsxs)("div",{className:"space-y-2",children:[(0,h.jsx)(m.J,{htmlFor:"code",children:"Verification Code"}),(0,h.jsx)(o.p,(0,s.A)({id:"code",type:"text",placeholder:"000000",className:"text-center text-2xl tracking-widest",maxLength:6},k("code"))),R.code&&(0,h.jsx)("p",{className:"text-sm text-red-600",children:R.code.message})]}),(0,h.jsx)(n.$,{type:"submit",className:"w-full",disabled:d,children:d?"Verifying...":"Verify Code"})]}),(0,h.jsxs)("div",{className:"text-center space-y-4",children:[(0,h.jsx)("p",{className:"text-sm text-gray-600",children:"Didn't receive the code?"}),(0,h.jsx)(n.$,{variant:"outline",onClick:async()=>{N(!0);try{var e;const t=await u.FH.post("/auth/resend-2fa/",{email:w});var a;if(null!==t&&void 0!==t&&null!==(e=t.data)&&void 0!==e&&e.success)v.oR.success("New verification code sent!");else v.oR.error((null===t||void 0===t||null===(a=t.data)||void 0===a?void 0:a.message)||"Failed to send verification code.")}catch(t){v.oR.error("Failed to send verification code. Please try again.")}finally{N(!1)}},disabled:y,className:"w-full",children:y?(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(x.A,{className:"h-4 w-4 mr-2 animate-spin"}),"Sending new code..."]}):(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(x.A,{className:"h-4 w-4 mr-2"}),"Resend code"]})}),(0,h.jsxs)("p",{className:"text-sm text-gray-600",children:["Having trouble?"," ",(0,h.jsx)(r.N_,{to:"/auth/sign-in",className:"text-blue-600 hover:text-blue-500 font-medium",children:"Back to Sign In"})]})]})]})}}}]);